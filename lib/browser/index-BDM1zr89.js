import{c as w,r as l,z as M,cy as W,cz as C,j as n,bX as T,bY as j,ca as k,bZ as L,bG as A,cx as B,cA as V,ct as $,cB as N,c7 as P}from"./index-Bil1Hr5a.js";import{a as G}from"./useBasicWidgetState-CuWiximn.js";const H=w("div",{target:"e6zijwc0"})(({theme:i})=>({"span[aria-disabled='true']":{background:i.colors.fadedText05}}),""),O=(i,a)=>i.getIntArrayValue(a),E=i=>i.default??null,F=i=>i.value??null,U=(i,a,t,p)=>{a.setIntArrayValue(i,t.value,{fromUi:t.fromUi},p)},D=i=>{var a;const{element:t,widgetMgr:p,fragmentId:S}=i,e=M(),[s,m]=G({getStateFromWidgetMgr:O,getDefaultStateFromProto:E,getCurrStateFromProto:F,updateWidgetMgrState:U,element:t,widgetMgr:p,fragmentId:S}),u=t.maxSelections>0&&s.length>=t.maxSelections,f=l.useMemo(()=>{if(t.maxSelections===0)return"No results";if(s.length===t.maxSelections){const o=t.maxSelections!==1?"options":"option";return`You can only select up to ${t.maxSelections} ${o}. Remove an option first.`}return"No results"},[t.maxSelections,s.length]),v=l.useMemo(()=>s.map(o=>{const r=t.options[o];return{value:o.toString(),label:r}}),[t.options,s]),h=l.useCallback(o=>{const r=()=>{var c;const g=(c=o.option)==null?void 0:c.value;return parseInt(g,10)};switch(o.type){case"remove":return W(s,r());case"clear":return[];case"select":return s.concat([r()]);default:throw new Error(`State transition is unknown: ${o.type}`)}},[s]),y=l.useCallback(o=>{t.maxSelections&&o.type==="select"&&s.length>=t.maxSelections||m({value:h(o),fromUi:!0})},[t.maxSelections,h,m,s.length]),x=l.useCallback((o,r)=>{if(u)return[];const c=o.filter(g=>!s.includes(Number(g.value)));return C(c,r)},[u,s]),{options:d}=t,b=d.length===0?!0:i.disabled,z=d.length===0?"No options to select.":t.placeholder,R=d.map((o,r)=>({label:o,value:r.toString()})),I=d.length>10;return n.jsxs("div",{className:"stMultiSelect","data-testid":"stMultiSelect",children:[n.jsx(T,{label:t.label,disabled:b,labelVisibility:j((a=t.labelVisibility)==null?void 0:a.value),children:t.help&&n.jsx(k,{children:n.jsx(L,{content:t.help,placement:A.TOP_RIGHT})})}),n.jsx(H,{children:n.jsx(B,{options:R,labelKey:"label",valueKey:"value","aria-label":t.label,placeholder:z,type:N.select,multi:!0,onChange:y,value:v,disabled:b,size:"compact",noResultsMsg:f,filterOptions:x,closeOnSelect:!1,overrides:{Popover:{props:{overrides:{Body:{style:()=>({marginTop:e.spacing.px})}}}},SelectArrow:{component:$,props:{overrides:{Svg:{style:()=>({width:e.iconSizes.xl,height:e.iconSizes.xl})}}}},IconsContainer:{style:()=>({paddingRight:e.spacing.sm})},ControlContainer:{style:{minHeight:e.sizes.minElementHeight,borderLeftWidth:e.sizes.borderWidth,borderRightWidth:e.sizes.borderWidth,borderTopWidth:e.sizes.borderWidth,borderBottomWidth:e.sizes.borderWidth}},Placeholder:{style:()=>({flex:"inherit",opacity:"0.7"})},ValueContainer:{style:()=>({paddingLeft:e.spacing.sm,paddingTop:e.spacing.none,paddingBottom:e.spacing.none,paddingRight:e.spacing.none})},ClearIcon:{props:{overrides:{Svg:{style:{color:e.colors.darkGray,padding:e.spacing.threeXS,height:e.sizes.clearIconSize,width:e.sizes.clearIconSize,cursor:"pointer",":hover":{fill:e.colors.bodyText}}}}}},SearchIcon:{style:{color:e.colors.darkGray}},Tag:{props:{overrides:{Root:{style:{borderTopLeftRadius:e.radii.md,borderTopRightRadius:e.radii.md,borderBottomRightRadius:e.radii.md,borderBottomLeftRadius:e.radii.md,fontSize:e.fontSizes.md,paddingLeft:e.spacing.sm,marginLeft:e.spacing.none,marginRight:e.spacing.sm,height:`calc(${e.sizes.minElementHeight} - 2 * ${e.spacing.xs})`,maxWidth:`calc(100% - ${e.spacing.lg})`,cursor:"default !important"}},Action:{style:{paddingLeft:0}},ActionIcon:{props:{overrides:{Svg:{style:{width:"0.625em",height:"0.625em"}}}}}}}},MultiValue:{props:{overrides:{Root:{style:{fontSize:e.fontSizes.sm}}}}},Input:{props:{readOnly:P.isMobile&&I===!1?"readonly":null}},Dropdown:{component:V}}})})]})},X=l.memo(D);export{X as default};
